# Определение персонажей игры.
define r = Character('Расказчик', color="#530000") # Главный герой (мы играем от его лица, имя можно раскрыть позже)
define d = Character('Даниил', color="#220761")
define n = Character('Назар', color="#154602")
define unknown = Character('???', color="#666666")
define system = Character('Система', color="#ff5555")

# Игра начинается здесь:
label start:
    scene bg office day
    play music "audio/ambient_office.ogg" fadein 2.0

    "Скука."
    "Монотонный стук клавиш сливается в белый шум. Взгляд упёрся в потолок, где уже пятый час мигает мертвая люминесцентная лампа."
    "Может, мне стоит уволиться с этой работы?"
    "Вздох. Всё равно рабочий день подходит к концу."
    "Ещё радует, что завтра суббота. Можно будет... даже не знаю, что. Поспать."

    show screen computer_screen
    "Я машинально потянулся к мышке, чтобы закрыть вкладки. На экране, среди бесчисленных таблиц, мелькнуло push-уведомление от новостного агрегатора."

    menu:
        "Проигнорировать и выключить компьютер.":
            $ checked_news = False
            "Не сегодня. Хватит с меня этого информационного шума. Я резко выдернул шнур питания из розетки. Монитор погас."
            hide screen computer_screen

        "Бегло глянуть на заголовки.":
            $ checked_news = True
            "Лень-матушка, но рука сама потянулась кликнуть."
            system "ВОЗ сообщает о росте случаев 'солнечной мигрени' в западных регионах..."
            system "Астрономы-любители сообщают о кратковременных аномалиях на диске Солнца. Вероятность вспышки M-класса повышена."
            system "Сеть: пользователи жалуются на временные сбои GPS и спутниковой связи."
            "Ничего нового. Очередные страшилки. Я выключил компьютер."
            hide screen computer_screen

    scene bg street day with fade
    play sound "audio/street_ambience.ogg"

    "Выбравшись на улицу, я потянул носом воздух. Что-то было не так."
    "Не так пахло. Слишком... тихо. Да, машин было меньше обычного для пятницы."
    "Я поднял голову, чтобы посмотреть на закат."

    # Эффект постепенного затемнения и смены цвета неба
    scene bg street sunset with dissolve
    "Небо было цвета старой синячной желтизны. Солнца не было видно."
    "Не просто за тучей. Оно будто... растворилось в этой странной, равномерной пелене. Свет был, но не от конкретного источника. Он исходил ото всего неба сразу, плоский и безжизненный."
    play music "audio/tense_ambient.ogg" fadeout 1.0 fadein 1.0

    "По спине пробежали мурашки. Это было не просто странно. Это было неправильно."

    # Вибрация телефона
    play sound "audio/phone_vibrate.ogg"
    "В кармане завибрировал телефон."

    menu:
        "Посмотреть телефон.":
            "Я достал его. Экран был залит предупреждениями системы."
            system "ЭКСТРЕННОЕ СООБЩЕНИЕ: Избегайте длительного нахождения на открытой местности. Вернитесь в укрытие. Оставайтесь в помещении."
            system "Сигнал GPS недоступен."
            system "Сотовая сеть перегружена."
            "Что за бред? Какое укрытие?"
            $ saw_message = True

        "Проигнорировать. Скорее домой.":
            "Не сейчас. Какая-то ерунда. Надо просто добраться до дома."
            $ saw_message = False

    "Я ускорил шаг. Воздух становился гуще, свет — всё более неестественным, будто фильтр в плохом кино."
    "Впереди, у подъезда моего дома, я заметил знакомую фигуру."

    show nazar normal at center with dissolve
    n "Эй! Ты тоже это видишь?"
    "Это был Назар, сосед с третьего этажа. Обычно спокойный парень, сейчас он выглядел бледным и растерянным."
    r "Видеть что? Это небо?"
    n "Да! Солнце просто... исчезло. Я ждал закат с фотоаппаратом, а оно взяло и потухло, как лампочка. Не зашло. Потухло!"
    n "И смотри!"

    show nazar scared with dissolve
    "Он ткнул пальцем в экран своего смартфона. На нём была открыта карта. Местоположение показывалось где-то в 50 километрах от нашего города, хотя мы стояли на своём дворе."

    menu:
        "Это глюк. У всех так.":
            r "Наверное, солнечная вспышка, магнитная буря. Спутники сбились. Пройдёт."
            n "Ты действительно в это веришь? Послушай... тишину."
            "Я прислушался. Ни птиц, ни ветра. Только далёкий, приглушённый гул, источник которого нельзя было определить."

        "Со мной тоже что-то не так. Получил странные сообщения." if saw_message:
            r "Я получил экстренное оповещение. Говорят, прятаться."
            n "Дай посмотреть!"
            "Я показал ему свой телефон. Он внимательно изучил сообщение, его лицо стало ещё мрачнее."
            n "Это не локально. Я только что говорил с сестрой из другого города. У них то же самое. Всюду."

        "Нам нужно зайти внутрь.":
            r "Стоять здесь и паниковать бесполезно. Идём ко мне, обсудим."
            n "Да... да, ты прав."

    play sound "audio/phone_ringtone.ogg"
    "Внезапно зазвонил мой телефон. Незнакомый номер."
    menu:
        "Ответить.":
            $ answered_call = True
            r "Алло?"
            unknown "Не смотрите на небо. Долго. Не доверяйте..."
            "Голос был искажён, прерывался сильными помехами."
            r "Кто это? Что происходит?"
            unknown "...они видят через свет... найдите тень... исчез..."
            "Связь прервалась."
            n "Что? Кто это был?"
            r "Не знаю. Говорил какую-то белиберду."

        "Проигнорировать.":
            $ answered_call = False
            "Сейчас не до звонков. Я отклонил вызов."
            n "Кто звонил?"
            r "Неизвестный. Лучше не отвечать."

    stop music fadeout 3.0
    scene bg apartment night with fade
    play music "audio/mystery_dark.ogg" fadein 2.0
    "Мы зашли в мою квартиру. Я щёлкнул выключателем. Свет замигал раз, другой и погас."
    "Аварийное освещение в подъезде тоже не работало. Единственный свет — тот самый, мертвенно-жёлтый, лился из окна."

    show nazar scared at center with dissolve
    n "Электричество отключили везде. У меня в телефоне 10%. Что будем делать?"
    "Вопрос повис в воздухе. За окном, в этом неправильном свете, мир замер."

    # Конец введения. Игрок сделал первые выборы, которые повлияют на дальнейшее развитие.
    # Переменные: checked_news, saw_message, answered_call

    r "Сначала нужно понять, что происходит. Потом — выживать."
    "Я подошёл к окну и прикрыл штору, отсекая жуткий свет. В комнате стало темно, но это была привычная, безопасная темнота ночи."
    "Но ночи ещё не наступило. И, похоже, она не наступит ещё очень долго."

    # Здесь можно сделать развилку: остаться в квартире или попытаться куда-то идти.
    # Это отличная точка для сохранения и перехода к следующей главе.
    n "Думаешь, это надолго?"
    r "Не знаю. Но готовься ко всему."

    window hide
    show text "{size=+10}Глава 1: Исчезновение{/size}" with dissolve
    pause 2.0
    hide text with dissolve
    window show

    # Сцена заканчивается, но история только начинается.
    # Вы можете продолжить сцену или начать новую главу с метки 'chapter2'.

    return

# Экран для имитации компьютера (опционально, требует изображения)
screen computer_screen():
    add "images/monitor.png" align (0.5, 0.5)